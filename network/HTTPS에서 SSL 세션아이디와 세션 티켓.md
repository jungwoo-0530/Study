# HTTPS에서 SSL 세션 아이디(Session ID)와 세션 티켓(Session Ticket)차이





## HTTP

- HTTP는 웹브라우저(Client)와 서버(Server)간의 웹페이지같은 자원을 주고 받을 때 쓰는 통신 규약
- http는 텍스트(평문) 교환. html 페이지도 텍스트.
- 단순 텍스트(평문) 교환이기에 누군가 네트워크에서 신호를 가로채어 본다면 내용이 노출된다.
- 이러한 보안상의 문제를 해결해주는 프로토콜이 HTTPS.

## HTTPS

- Hypertext Transfer Protocol Over Secure Socket Layer = HTTP + SSL
- 인터넷 상에서 정보를 암호화하는 **SSL(Secure Socket Layer) 프로토콜**을 이용하여 웹브라우저(Client)와 서버가 데이터를 주고 받는 통신 규약.
- HTTP는 원래 TCP와 통신하지만 HTTPS에서 HTTP는 SSL과 통신하고 SSL이 TCP와 통신한다.
- 기본 포트 443
- 대칭키와 공개키 암호화 방식을 혼합하여 보안 통신을 구현한다.
  - 대칭키 : 두 명의 사용자가 있을 때, 둘 모두가 **같은 암호키**를 가지고 대화. 같은 암호키로 복호화, 암호화.
  - 대칭키를 공개키 암호화 방식으로 교환한 다음, 그 후 통신은 대칭키를 사용하는 방식이다.
  - 공개키 알고리즘
    - 서로 다른 2개의 키(공개키, 개인키)가 존재 - 공개키 누구나 획득할 수 잇는 키. 개인키는 누구나 획득할 수 없다.
      - 공개키, 개인키의 관계는 **공개키로 암호화 -> 개인키로 복호화, 개인키로 암호화 -> 공개키로 복호화가 가능하다.**
    - 공개키로 암호화, 개인키로 복호화
    - 클라이언트가 공개키로 암호화하여 서버에게 전송.
    - 서버는 개인키로 암호화된 데이터를 복호화.
    - 클라이언트가 요청한 데이터를 서버는 개인키로 암호화하고 클라이언트에게 전송
    - 클라이언트는 공개키로 서버로 온 암호화된 데이터를 복호화하여 유저에게 보여준다.
    - 키포인트 : 여기서 공개키는 누구나 공개된 키인데, 서버가 개인키로 암호화해서 온 응답은 누구나 공개키로 볼 수 있는데 의미가 있을까?
      - 서버에서 개인키로 암호화하고 공개키로 복호화를 했기 때문에, **해당 응답이 서버로 부터 온 응답임을 확신할 수 있다.**
- 자세한 HTTPS 통신 흐름 - 클라이언트, 서버, CA(Certificate Authority) 기업.
  - A서버에서 공개키와 개인키를 만든다.
  - 신뢰할 수 있는 **CA 기업**을 선택해서 **A서버에서 만든 공개키를 관리**해달라고 계약을 한다.
  - 계약을 한 CA기업 또한 **CA기업만의 공개키와 개인키**가 있다.
    - 즉, CA기업이 **A서버의 공개키, 공개키의 암호화 방법 등의 정보를 담은 인증서**를 만들고, 해당 **인증서를 CA기업의 개인키로 암호화해서 A서버에게 제공.**
  - A서버는 암호화된 인증서를 갖게 되었습니다. 이제 A서버는 A서버의 공개키로 암호화된 HTTPS 요청이 아닌 요청이 오면 이 암호화된 인증서를 클라이언트에게 줍니다.
  - 이제 클라이언트 입장에서, A서버로 index.html 파일을 요청. 그러면 HTTPS 요청이 아니기 때문에 **CA 기업이 A 서버의 정보를 CA 기업의 개인키로 암호화된 인증서**를 받는다.
  - 브라우저는 세계적으로 신뢰할 수 있는 **CA 기업의 공개키는 이미 알고** 있다.
  - 브라우저가 CA 리스트를 탐색하면서 인증서에 적혀있는 CA 기업 이름이 같으면 해당 **CA 기업의 공개키를 이미 알고 있는 브라우저는 인증서를 복호화**. 복호화를 함으로써 **인증서 안에있는 A 서버의 공개키를 획득**.
  - 이제 A서버와 통신할 때, **A서버의 공개키로 암호화해서 요청**을 한다.





## SSL

- 
- SSL이 제공하는 기능
  - 클라이언트가 접속한 서버가 의도한 서버임을 보장
  - 클라이언트와 서버가 통신할 때, 암호화 할 수 있도록 서버의 공개키를 제공.

- SSL 통신 과정
  - 브라우저는 이미 CA 업체들의 리스트를 알고있음.
  - 브루아저를 통해 사용자가 웹 서비스를 접근.
  - 웹서비스(Client)는 CA기관을 통해 발급받은 **SSL인증서(인증기관의 비밀키로 암호화 되어있다.)**를 사용자에게 전달.
  - 브라우저는 SSL 인증서가 CA업체 리스트에 포함되어 있는지 확인.
  - 포함되어 있다면, 브라우저는 해당 SSL 인증서에 대응하는 CA 리스트에 존재하는 공개키(CA업체 공개키)를 이용해 SSL인증서를 복호화.
    - **복호화가 성공했다면 이에 대응되는 비밀키로 암호화가 되었다는 의미이므로, SSL인증서에 해당하는 서비스의 응답임을 확신(신뢰)할 수 있다. 즉, 신뢰할 수 있는 서버임을 알 수 있다.**

### SSL 인증서

- SSL 인증서는 서버가 정말 그 서버가 맞는지를 확인할 수 있도록 도와주는 수단.